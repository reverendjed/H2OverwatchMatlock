{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./App.css';import{BrowserRouter as Router,Route,Routes,Navigate}from'react-router-dom';import{auth}from'./firebase-config';import{onAuthStateChanged,signOut}from\"firebase/auth\";import UserDashboard from'./components/UserDashboard';import UserRegistrationForm from'./components/UserRegistrationForm';import AdminDashboard from'./components/AdminDashboard';import Login from'./components/Login';// Ensure this path matches where your Login component is saved\nimport{fetchUserRole}from'./services/firebaseService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[userRole,setUserRole]=useState(null);// State to store user role\nuseEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async currentUser=>{if(currentUser){setUser(currentUser);// Fetch user role once authenticated\nconst role=await fetchUserRole(currentUser.uid);setUserRole(role);}else{setUser(null);setUserRole(null);// Reset user role if not logged in\n}});return()=>unsubscribe();},[]);const handleLogout=async()=>{try{await signOut(auth);setUser(null);// Clear user state upon logout\nconsole.log(\"User signed out successfully\");}catch(error){console.error(\"Error signing out:\",error.message);}};return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/UserDashboard\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/Login\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/Login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/UserDashboard\",element:/*#__PURE__*/_jsx(UserDashboard,{handleLogout:handleLogout})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(UserRegistrationForm,{})}),/*#__PURE__*/_jsx(Route,{path:\"/AdminDashboard\",element:/*#__PURE__*/_jsx(AdminDashboard,{})})]})})});}export default App;","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Router","Route","Routes","Navigate","auth","onAuthStateChanged","signOut","UserDashboard","UserRegistrationForm","AdminDashboard","Login","fetchUserRole","jsx","_jsx","jsxs","_jsxs","App","user","setUser","userRole","setUserRole","unsubscribe","currentUser","role","uid","handleLogout","console","log","error","message","children","className","path","element","to","replace"],"sources":["/Users/jeffryjones/Desktop/h2overwatch/login/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './App.css';\nimport { BrowserRouter as Router, Route, Routes, Navigate } from 'react-router-dom';\nimport { auth } from './firebase-config';\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\nimport UserDashboard from './components/UserDashboard';\nimport UserRegistrationForm from './components/UserRegistrationForm';\nimport AdminDashboard from './components/AdminDashboard';\nimport Login from './components/Login'; // Ensure this path matches where your Login component is saved\nimport { fetchUserRole } from './services/firebaseService';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [userRole, setUserRole] = useState(null); // State to store user role\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\n      if (currentUser) {\n        setUser(currentUser);\n        // Fetch user role once authenticated\n        const role = await fetchUserRole(currentUser.uid);\n        setUserRole(role);\n      } else {\n        setUser(null);\n        setUserRole(null); // Reset user role if not logged in\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleLogout = async () => {\n    try {\n      await signOut(auth);\n      setUser(null); // Clear user state upon logout\n      console.log(\"User signed out successfully\");\n    } catch (error) {\n      console.error(\"Error signing out:\", error.message);\n    }\n  };\n\n  return (\n    <Router>\n      <div className=\"App\">\n        <Routes>\n          {/* Redirect users to UserDashboard if they are logged in, otherwise to the Login page */}\n          <Route path=\"/\" element={user ? <Navigate to=\"/UserDashboard\" replace /> : <Navigate to=\"/Login\" replace />} />\n          <Route path=\"/Login\" element={<Login />} />\n          <Route path=\"/UserDashboard\" element={<UserDashboard handleLogout={handleLogout} />} />\n          <Route path=\"/register\" element={<UserRegistrationForm />} />\n          <Route path=\"/AdminDashboard\" element={<AdminDashboard />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}